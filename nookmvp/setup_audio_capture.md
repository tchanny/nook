# Настройка записи системного звука для Google Meet/Zoom

## Проблема
При использовании наушников микрофон записывает только ваш голос, но не голоса собеседников из Google Meet/Zoom.

## Решения

### 1. Установка BlackHole (бесплатно)

```bash
# Установка через Homebrew
brew install blackhole-2ch

# Или скачать с GitHub
# https://github.com/ExistentialAudio/BlackHole/releases
```

**Настройка:**
1. Открой "Аудио MIDI настройки" (Audio MIDI Setup)
2. Создайте Multi-Output Device:
   - Нажмите "+" → "Создать Multi-Output Device"
   - Добавьте "BlackHole 2ch" и ваши наушники
   - Установите как устройство по умолчанию

3. В Системных настройках → Звук → Вход:
   - Выберите "BlackHole 2ch" как источник записи

### 2. Установка Loopback (платно, но удобнее)

```bash
# Скачать с https://rogueamoeba.com/loopback/
```

**Настройка:**
1. Создайте новый источник
2. Добавьте "Системный звук" и "Микрофон"
3. Настройте уровни громкости
4. Выберите как источник для записи

### 3. Программное решение (macOS)

```bash
# Установка дополнительных инструментов
brew install sox
brew install ffmpeg
```

**Скрипт для смешивания аудио:**
```bash
#!/bin/bash
# mix_audio.sh - смешивает системный звук и микрофон

# Запись системного звука
ffmpeg -f avfoundation -i ":0" -acodec pcm_s16le system_audio.wav &

# Запись микрофона
ffmpeg -f avfoundation -i ":1" -acodec pcm_s16le microphone.wav &

# Смешивание
sox -m system_audio.wav microphone.wav mixed_audio.wav
```

### 4. Простое решение без наушников

1. Используйте встроенные динамики ноутбука
2. Микрофон подхватит и ваш голос, и голос собеседника
3. Diarization автоматически разделит на разных спикеров

## Проверка работы

1. Запустите Google Meet/Zoom
2. Запустите движок: `./start_nook_engine.sh`
3. В приложении нажмите "Запись"
4. Говорите с собеседником
5. Проверьте, что в транскрипции видны оба голоса с разными цветами

## Устранение проблем

### Нет звука из BlackHole
- Проверьте, что BlackHole добавлен в Multi-Output Device
- Убедитесь, что громкость BlackHole не на нуле
- Перезапустите приложения

### Эхо в записи
- Уменьшите громкость динамиков
- Используйте наушники с хорошей изоляцией
- Настройте уровни в Loopback/BlackHole

### Плохое качество записи
- Увеличьте частоту дискретизации до 48kHz
- Используйте внешний микрофон
- Настройте уровни громкости

## Автоматическая настройка

Движок автоматически ищет устройства с поддержкой системного звука:
- BlackHole
- Loopback  
- System Audio Mix
- Multi-Output Devices

Если найдены такие устройства, они будут использованы вместо обычного микрофона.
